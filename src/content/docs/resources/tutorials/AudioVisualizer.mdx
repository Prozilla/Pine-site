---
title: Audio Visualizer
description: Learn how to make a simple audio visualizer app with Pine.
sidebar:
  hidden: true
---

import JavadocLink from "~/components/JavadocLink.astro";

This tutorial will show you how to make a simple audio visualizer step by step.

![A screenshot of the audio visualizer](../../../../assets/tutorials/audio-visualizer/audio-visualizer-complete.png)

## Prerequisites

- A Java project with [Pine installed](../guides/installation)
- Your preferred IDE
- Some `.ogg` audio files in your project's resources folder

If you don't have any audio files, you can check out [Andrew Applepie's work](https://andrewapplepie.bandcamp.com/).
Some of his music is free to download.
**Disclaimer:** Before redistributing or sharing any audio, make sure to review and comply with its license terms.

## Main class

A Java program needs an entry point, a main class.
This class is usually called `Main` and has always a method `public static void main(String[] args)`. 
In our case, we will be using this method to set up and run our application using the <JavadocLink name="dev.prozilla.pine.core.ApplicationBuilder"/>.

Before we do that, we will first declare some constants outside of the method, to avoid hardcoding variables and to make it easier to adjust minor details of our application later on.

```java
public class Main {
	
	public static final String TITLE = "Audio Visualizer";
	public static final int WIDTH = 900;
	public static final int HEIGHT = 450;
	public static final int FPS = 60; // Frames per second
	
	public static void main(String[] args) {
		
	}
	
}
```

Now we simply take these constants and apply them to our application builder.
Once that's done, all there is left to do is to tell the application builder to start the application.

```java
public static void main(String[] args) {
	ApplicationBuilder applicationBuilder = new ApplicationBuilder();
	
	applicationBuilder.setTitle(TITLE);
	applicationBuilder.setWindowSize(WIDTH, HEIGHT);
	applicationBuilder.setInitialScene(new Scene());
	applicationBuilder.setTargetFps(FPS);
	
	applicationBuilder.buildAndRun();
}
```

And that's it, we now have a working Pine application! You can go ahead and run your program and you'll see a blank 900x450 window open, with the title "Audio Visualizer", rendering at 60 frames per second.

## Scene

To actually add entities into our application and render stuff, we have to create a <JavadocLink name="dev.prozilla.pine.core.scene.Scene"/>. 
The scene keeps track of all our entities, components and systems.

Let's create a new class for our scene to keep things organised.
Just like our main class, this class will also contain some constants.

```java
public class AudioVisualizerScene extends Scene {
	
	public static final int BAR_COUNT = 25;
	public static final float BAR_GAP = 4;
	public static final float VOLUME = 0.25f;

}
```

This won't do anything on its own, we still have to load the entities, components and systems into our scene.
To do this, we'll override the scene's `load()` method.

A scene is always initialized with a camera entity.
To access its camera component, we use the `cameraData` field.
We'll be using this to change the background color of our camera.

```java
@Override
protected void load() {
	super.load();
	
	cameraData.setBackgroundColor(Color.hsl(0f, 0f, 0.05f));
}
```

Go ahead and run the application again and you'll see that our background color has changed slightly. That's progress!
It's a good idea to run your application frequently when making changes, to verify that everything is working correctly before moving on.

Next, we'll want to play some audio.
The audio source pool lets us load an audio source from an audio file inside our resources folder.
In this example, the audio file is located at `src/main/resources/audio/AndrewApplepie-KeepOnTrying.ogg`.

```java
public class AudioVisualizerScene extends Scene {
	
	private AudioSource source;
	
	...
	
	@Override
	protected void load() {
		...
		
		// Load audio source
		source = AssetPools.audioSources.load("audio/AndrewApplepie-KeepOnTrying.ogg");
		source.setCapture(true); // Enables capturing of audio data
		source.init();
		
		// Start audio source
		source.setVolume(VOLUME);
		source.setLoop(true);
		source.play();
	}
	
}

```

When we run our application again, we should be able to hear our audio playing.
We still can't see anything though, so let's do something about that.

To visualize our audio, we'll be using vertical bars.
We'll create each bar using a prefab with a custom component that stores the data of each bar.
And finally, a system will be added to our scene to animate the bars based on the audio data.

### Bar component

The only data our custom component will be storing is the index of the bar it is attached to.
We'll need this information later on to update the horizontal position and color of each bar.

```java
public class BarData extends Component {
	
	public final int index;
	
	public BarData(int index) {
		this.index = index;
	}
	
}
```

### Bar prefab

Like mentioned earlier, we'll create each bar using a prefab.
A prefab is a reusable blueprint that creates entities with a predefined set of components.
We'll extend the <JavadocLink name="dev.prozilla.pine.core.entity.prefab.shape.RectPrefab"/> class, because each bar will also need a <JavadocLink name="dev.prozilla.pine.core.component.shape.RectRenderer"/> component to render the actual rectangles.

```java
public class BarPrefab extends RectPrefab {
	
	protected int index;
	
	public BarPrefab() {
		super(new Rect(), Color.white());
		index = 0;
	}
	
	public void setIndex(int index) {
		this.index = index;
	}
	
	@Override
	protected void apply(Entity entity) {
		super.apply(entity);
		
		entity.transform.position.y = -Main.HEIGHT / 2f;
		entity.addComponent(new BarData(index));
		
		// Create new shape for the next bar
		setShape(new Rect());
	}
	
}
```

